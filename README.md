# Практическая работа: Система управления начислениями за коммунальные услуги

## Описание проекта

Программа для работы с базой данных граждан, пользующихся коммунальными услугами, с функциональностью генерации извещений на оплату в формате Excel.

## Структура проекта

- `date_time_utils.py` - Классы для работы с датой и временем
- `models.py` - Классы данных (Улицы, Лицевые счета, Услуги, Начисления)
- `database.py` - Класс для работы с базой данных
- `chain_of_responsibility.py` - Реализация паттерна Chain of Responsibility для обработки начислений
- `excel_generator.py` - Генератор Excel-файлов с извещениями на оплату
- `main.py` - Главный модуль программы

## Установка и запуск

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Запустите программу:
```bash
python main.py
```

## Функциональность

### 1. Классы для работы с датой и временем

Модуль `date_time_utils.py` содержит класс `DateTimeHandler` с методами для:
- Получения текущей даты/времени
- Форматирования дат
- Парсинга дат из строк
- Работы с периодами (месяц, год)
- Получения названий месяцев

### 2. Модели данных

- **Street** - Улицы (код улицы, название)
- **PersonalAccount** - Лицевые счета (код счета, номер счета, код улицы, дом, корпус, квартира, ФИО)
- **Service** - Услуги (код услуги, название, тариф)
- **Charge** - Начисления (код начисления, код счета, код услуги, количество)

### 3. Паттерн Chain of Responsibility

Реализована цепочка обработчиков начислений:
1. **ValidationChargeHandler** - Валидация данных начисления
2. **DiscountChargeHandler** - Применение скидки при превышении порога
3. **StandardChargeHandler** - Стандартная обработка начисления

Каждый обработчик может передать обработку следующему звену цепи.

### 4. Генерация Excel-файлов

Программа генерирует Excel-файлы с извещениями на оплату, содержащими:
- Информацию о лицевом счете и абоненте
- Адрес
- Период начисления
- Таблицу начислений с услугами
- Итоговую сумму к оплате

## Контекстная диаграмма

```
┌─────────────────┐
│   Абонент       │
│                 │
│  - Просмотр     │
│    извещения    │
│  - Оплата       │
└────────┬────────┘
         │
         │ запрашивает извещение
         ▼
┌─────────────────────────────────┐
│      Система управления         │
│      начислениями               │
│                                 │
│  ┌──────────────────────────┐  │
│  │  Database                │  │
│  │  - Улицы                 │  │
│  │  - Лицевые счета         │  │
│  │  - Услуги                │  │
│  │  - Начисления            │  │
│  └──────────────────────────┘  │
│                                 │
│  ┌──────────────────────────┐  │
│  │  ChargeProcessor         │  │
│  │  (Chain of Responsibility)│  │
│  │  - Валидация             │  │
│  │  - Скидки                │  │
│  │  - Расчет стоимости      │  │
│  └──────────────────────────┘  │
│                                 │
│  ┌──────────────────────────┐  │
│  │  ExcelGenerator          │  │
│  │  - Формирование извещения│  │
│  └──────────────────────────┘  │
└────────┬────────────────────────┘
         │
         │ генерирует извещение
         ▼
┌─────────────────┐
│   Бухгалтер     │
│                 │
│  - Формирование │
│    извещений    │
│  - Контроль     │
│    начислений   │
└────────┬────────┘
         │
         │ предоставляет отчеты
         ▼
┌─────────────────┐
│   Руководитель  │
│                 │
│  - Анализ       │
│    начислений   │
│  - Принятие     │
│    решений      │
└─────────────────┘
```

## Примеры использования

### Создание извещения для лицевого счета

```python
from database import Database
from main import init_database, create_payment_notice
from chain_of_responsibility import ChargeProcessor
from excel_generator import ExcelGenerator

# Инициализация
db = init_database()
processor = ChargeProcessor()
excel_gen = ExcelGenerator()

# Создание извещения
notice = create_payment_notice(db, account_code=1, period_month=11, period_year=2024)
notice = processor.process_notice(notice)

# Генерация Excel
excel_gen.generate_payment_notice(notice, "извещение.xlsx")
```

## Автор

Выполнено в рамках практической работы по ООП.

